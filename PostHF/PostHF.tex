% !TeX program = lualatex
% !TeX encoding = utf8
% !TeX spellcheck = uk_UA
% !BIB program = biber

\documentclass[]{beamer}
\usetheme{QuantumChemistry}
\usepackage{QuantumChemistry}
\usepackage{minted}
\graphicspath{{pictures/}}
\addbibresource{../Bibliography/QuantumChemistry.bib}
\AtEveryCitekey{\clearfield{url}\clearfield{doi}}
\usetikzlibrary{chains, positioning}
%\usepackage{ragged2e}


\newcommand\vertarrowbox[3][6ex]{%
  \begin{array}[t]{@{}c@{}} #2 \\
  \left\uparrow\vcenter{\hrule height #1}\right.\kern-\nulldelimiterspace\\
  \makebox[0pt]{\scriptsize#3}
  \end{array}%
}
\def\connect#1#2#3{%
    % #1: starting node
    % #2: ending node
    % #3: attributes for the shape connecting nodes
    \path let
      \p1 = ($(#2)-(#1)$),
      \n1 = {veclen(\p1)},
      \n2 = {atan2(\y1,\x1)} % <- Update
    in
      (#1) -- (#2) node[#3,
      midway,
      rotate = \n2,
      shading angle = \n2+90,
      minimum
      height=\n1,
      minimum
      width=5pt,
      inner sep=1pt] {};
            }
\title[Лекції з квантової хімії]{\huge\bfseries Пост Хартрі-Фоківські методи}
\subtitle{Лекції з квантової хімії}
\author{Пономаренко С. М.}
\date{}
\let\vphi\varphi
\def\vxi{\vec{\xi}}
\begin{document}
%=============================================================================

\begin{frame}
	\thispagestyle{empty}
	\titlepage
	\epigraph{Істотний прихований дефект методу Хартрі-Фока полягає у нехтуванні електронною кореляцією в русі електронів з антипаралельними спінами.}{Попл Д. Е.}
\end{frame}
%=============================================================================

%%============================================================================
%\begin{frame}{Зміст}{}
%	\tableofcontents
%\end{frame}
%%============================================================================

%============================================================================
\begin{frame}{Сер Джон Ентоні Попл}{Лауреат Нобелівської премії по хімії (1998)}
	\begin{columns}
		\begin{column}{0.35\linewidth}
			\begin{center}
				\includegraphics[width=\linewidth]{pople_john}\\
				\href{https://en.wikipedia.org/wiki/John_Pople}{\scriptsize Попл Дж.~Е.  (1925 -- 2004)}
			\end{center}
		\end{column}
		\begin{column}{0.65\linewidth}

			\begin{block}{\small\fullcite{Popl:2002}}\itshape\justifying
				Істотний прихований дефект методу Хартрі-Фока полягає у нехтуванні електронною кореляцією в русі електронів з антипаралельними спінами ({\color{red}$\alpha\beta$-кореляція}).

				\medskip

				При використанні однодетермінантних хвильових функцій неявно мається на увазі нехтування електронною $ \alpha\beta $-кореляцією; робота з уточненими хвильовими функціями неминуче означає \alert{використання кількох детермінантів}.
			\end{block}

		\end{column}
	\end{columns}
\end{frame}
%============================================================================

%=============================================================================
%\begin{frame}[t]{Гамільтоніан системи}
%
%	\begin{multline*}
%		\hat{H} = \hat{T}_{n} + \hat{T}_{e} + \hat{V}_{en} + \hat{V}_{ee} + \ldots = \\ = -\frac12 \sum\limits_{i}^{N_e} \vec{\nabla}^2_i - \sum\limits_\alpha^{N_n}\sum\limits_{i}^{N_e} \frac{Z_\alpha}{r_i} + \frac12 \sum\limits_{i}^{N_e}\sum\limits_{\substack{j,\, j \neq i}}^{N_e}\frac{1}{r_{ij}}+\\ + \sum\limits_{\alpha}\sum\limits_{\beta, \alpha \neq \beta}\frac{Z_\alpha Z_\beta}{R_{\alpha\beta}} + \\ + \hat\varepsilon_{Orb-Spin} + \hat\varepsilon_{Spin-Spin} +\hat\varepsilon_{Orb-Orb},
%	\end{multline*}
%\end{frame}
%============================================================================

% ============================== Слайд ## ===================================
\begin{frame}{Основні риси методу Хартрі-Фока}{}\small
       \begin{enumerate}
\item \alert{\emph{Однодетермінантний підхід}}. Хвильова функція системи описується одним
детермінантом
Слейтера, що забезпечує антисиметричність щодо перестановки електронів (відповідає принципу Паулі).
Детермінант будується із зайнятих орбіталей, віртуальні орбіталі --- ігноруються.
\item \alert{\emph{Середньопольове наближення}}. Кожен електрон рухається в усередненому потенціалі,
створеному усіма іншими електронами та ядрами. Це ігнорує миттєві кореляції між електронами (так звані
\emph{динамічні} кореляції).
\item \alert{\emph{Обмінна взаємодія}}. Метод враховує обмінний ефект --- квантовомеханічне явище,
пов’язане з
нерозрізненністю електронів.  Він призводить до взаємодії електронів з однаковою спіновою координатою,
що призводить до зниження енергії.
\end{enumerate}

\begin{alertblock}{}\justifying
    Хартрі-Фоківське наближення --- це основа квантової хімії, яка враховує обмінну взаємодію та
    антисиметрію хвильової функції, але нехтує кореляційними ефектами. Воно служить відправною точкою
    для більш точних методів.
\end{alertblock}

\end{frame}
% ===========================================================================


%============================================================================
\begin{frame}{Що не точно метод Хартрі-Фока?}

	\begin{onlyenv}<1>
		Що точно і що не точно в методі Хартрі-Фока:
		\begin{enumerate}
			\item  Відносно добре описує \alert{стан молекулярних систем поблизу їх стійких (рівноважних) конфігурацій}, що відповідають точкам мінімуму на поверхнях потенціальної енергії основного електронного стану;
			\item дає \alert{некоректні оцінки} не тільки \alert{енергій дисоціації}, а й \alert{енергетичних бар'єрів}, що відповідають перетворенню однієї стійкої молекулярної форми на іншу;
			\item не дозволяє розглядати \alert{збуджені електронні стани} молекул.
		\end{enumerate}
	\end{onlyenv}
	\begin{onlyenv}<2>
		Основні причини неточності:
		\begin{enumerate}
			\item Метод використовує \alert{наближення незалежних частинок}, а електронну взаємодію враховує як суму взаємодій кожного електрона із середньою електронною густиною інших електронів.

			      {\scriptsize\color{blue} Насправді, між усіма електронами існує миттєве кулонівське відштовхування, тобто, їхній рух корельований.}

			\item неповнота базисного набору функцій;
			\item нехтування релятивістськими ефектами;

			      {\scriptsize\color{blue} Важливо при розгляді важких атомів}

			\item відхилення від наближення Борна–Оппенгеймера.

			      {\scriptsize\color{blue} Відхилення від наближення Борна-Оппенгеймера зазвичай незначні для основного стану молекули.}
		\end{enumerate}
	\end{onlyenv}
\end{frame}
\begin{frame}{Енергія електронної кореляції}
	\begin{center}
		\begin{tikzpicture}[scale=0.6]
			\draw[-latex] (0,3.5) -- (0,11) node[left] {$E$};
			\draw (0,10) -- +(1,0) node[right, text=red!90!blue] (Ehf) {Енергія Хартрі-Фока};
			\draw (0,8) node (A) {} -- +(1,0) node[right, text=red!70!blue] (HFlim) {Хартрі-Фоківський ліміт};
			\draw[->] (Ehf.south) -- node[right, font=\scriptsize] {Покращення базисного набору} (Ehf.south|-HFlim.north);
			\draw (0,6)  -- +(1,0) node[right, text=red!50!blue] (PHF) {Пост Хартрі-Фоківські методи};
			\draw[->] (Ehf.south|-HFlim.south) coordinate (H) -- node[right, font=\scriptsize] {Врахування електронної кореляції} (H|-PHF.north);
			\draw (0,5) node (B) {} -- +(1,0) node[right, text width=7cm, text=red!30!blue] (Sh) {Точний розв'язок рівняння Шредінґера};
			\draw (0,4) -- +(1,0) node[right, text=red!10!blue] {Релятивістська енергія};

			\draw[<->] (A.west) -- ++(-0.5, 0) |- (B.west)
			node[text=red!80, left, pos=0.25]  {$\Delta E_\text{кор}$};
		\end{tikzpicture}
	\end{center}
	\begin{block}{}
		Результати розрахунків, виконаних за методом Хартрі-Фока, відрізняються від результатів, отриманих з точного розв'язку рівняння Шредінґера:
		\begin{equation*}
			\Delta E_\text{кор} = E_\text{точн} - E_\text{ХФ}
		\end{equation*}
	\end{block}
	%Ці відмінності пов'язують з кореляційними ефектами, маючи на увазі під цим кулонівську кореляцію.
	%	\begin{alertblock}{}\scriptsize
	%            Створення точних і ефективних методів для визначення внеску кореляції досі є актуальним предметом досліджень в квантової хімії.
	%        \end{alertblock}
\end{frame}
%============================================================================

% ============================== Слайд ## ===================================
\begin{frame}{Типи кореляцій}{}

	\begin{enumerate}
		\item Статична кореляція.

		      \begin{block}{}\justifying\scriptsize
			      \alert{Статична кореляція виникає, коли хвильову функцію неможливо описати одним
			      детермінантом}, наприклад, при наявності вироджених молекулярних орбіталей. Типовий
			      випадок --- гомолітичний розрив зв'язку в молекулі водню, де зв’язувальна та
			      розпушувальна орбіталі стають виродженими. У таких випадках використовуються два
			      детермінанти з рівними коефіцієнтами, і втрата енергії при використанні одного
			      детермінанта є енергією статичної кореляції.
		      \end{block}

		\item Динамічна кореляція.

		      \begin{block}{}\justifying\scriptsize
			      \alert{Динамічна кореляція обумовлена кулонівським відштовхуванням електронів і
			      завжди
			      присутня у багатьох електронних системах.} Вона описує рух електронів і вимагає
			      додаткових детермінантів для точного опису електронної структури. Врахування цієї
			      кореляції знижує загальну енергію системи.
		      \end{block}

	\end{enumerate}

\end{frame}
% ===========================================================================


% ============================== Слайд ## ===================================
\begin{frame}{Динамічна кореляція в атомі \ce{He}}{}
	\begin{block}{}\justifying
		Хіллераас вибрав функцію основного стану парагелію вигляді:
		\begin{equation*}\label{}
			\Phi = \phi_1(r_1)\phi_2(r_2)(1 + ar_{12}),
		\end{equation*}
		де параметр $a$ який можна підібрати варіаційними методами і який враховує кореляцію (при $a = 0$ кореляції нема).

		Розрахунок Хіллераас дав: $\zeta = 1.849$, $а = 0.364$. Повна енергія
		при використанні функції дорівнює $-2.891$ а.о.е., тобто відрізняється від експериментальної лише на $0.3$~\%.
	\end{block}
\end{frame}
% ===========================================================================

%============================================================================
\begin{frame}{Пост Хартрі-Фоківські методи}{}
	\begin{enumerate}
		\item \href{https://en.wikipedia.org/wiki/Configuration_interaction}{\color{blue}Конфігураційна взаємодія} (англ. Configuration interaction, CI).
		\item \href{https://en.wikipedia.org/wiki/Multi-configurational_self-consistent_field}{\color{blue}Багатоконфігураційне самоузгоджене поле} (англ. Multiconfigurational Self-Consistent Field, MCSCF).
		\item \href{https://en.wikipedia.org/wiki/M\%C3\%B8ller\%E2\%80\%93Plesset_perturbation_theory}{\color{blue}Теорія збурень Меллера-Плессета} (англ. Møller–Plesset perturbation theory: MP2, MP3, MP4 ...).
		\item \href{https://en.wikipedia.org/wiki/Density_functional_theory}{\color{blue}Теорія функціоналу електронної густини} (англ. Density-functional theory, DFT).
	\end{enumerate}
\end{frame}
%============================================================================



%============================================================================
\begin{frame}[fragile]{Метод конфігураційної взаємодії}{}
	\framesubtitle<1-3>{Ідея методу}
	\begin{onlyenv}<1>
		\begin{itemize}\small
			\item  Розв'язок рівнянь Хартрі-Фока для основного стану атома гелію дає двічі зайняту сферично-симетричну орбіталь ($s$-орбіталь), на якій розміщуються два $\alpha$ та $\beta$ електрони. \alert{Кореляція не врахована}.

			\item   Врахування кореляції в рух електронів руху представляє, мовою електронних збуджень, наступну ідею: електрони в збуджених станах займають орбіталі, які дозволяють їм знаходитись далі один від одного.

			      \medskip

			      Тому, для уточнення хвильової функції молекули треба до основного стану додати (з певним коефіцієнтом) функцію, яка міститиме збуджені орбіталі.

		\end{itemize}
		\begin{center}
			\input{tikz/MO.tikz}
		\end{center}
	\end{onlyenv}
	\begin{onlyenv}<2>
		\begin{enumerate}\small
			\item Розв'язок рівнянь Хартрі-Фока дає набір $M$ спін-орбіталей, а для побудови детермінанта Слейтера використовують лише $N$, які \alert{відповідають мінімальним орбітальним енергіям} ({\scriptsize\color{blue} Aufbau principle}).

			\item Частину з $M-N$ функцій, що залишилися (\alert{які відповідають віртуальним орбіталям}) використовують для \alert{побудови додаткових детермінантів Слейтера}.

			      \begin{block}{}\justifying\scriptsize
				      Ці детермінанти отримують заміною певної кількості спін-орбіталей
				      вихідного визначника $\Phi_{0}$ на відповідне число віртуальних
				      спін-орбіталей. Одержані детермінанти називають збудженими і позначають
				      як $\Phi_k$.

				      Хвильова функція має вигляд:
				      \begin{equation*}\label{}
					      \Phi = C_0\Phi_{0} + \sum_{k = 1}^{n} C_k\Phi_k,
				      \end{equation*}%
				      $ n $ --- число детермінантів.
			      \end{block}
			\item Задача пошуку $\Phi$ зводиться до варіаційної задачі з мінімізації електронної енергії шляхом варіювання коефіцієнтів $C_k$.

			      %        \item При формуванні набору $\{\Phi_K\}_{1,\ldots, L}$ часто \alert{обмежуються одно- та двократно-збудженими визначниками} по відношенню до $\Phi^{0}$ ({\scriptsize правило Кондона-Слейтера}). У такому варіанті метод називається ({\scriptsize\color{blue} CISD, Cl with single and double excitations}).
		\end{enumerate}
	\end{onlyenv}
	\begin{onlyenv}<3>
		\begin{block}{}\justifying\scriptsize
			У реальності електрони не просто «сидять» на своїх орбіталях. Вони постійно відчувають
			присутність
			одне одного й намагаються уникати надмірного наближення через кулонівське відштовхування.

			\bigskip

			Метод Хартрі-Фока це ігнорує --- він припускає, що кожен електрон рухається у середньому
			полі всіх інших.

			\bigskip

			Щоб краще описати дійсну поведінку електронів, ми додаємо збуджені стани, в яких електрони
			тимчасово
			«перестрибують» на віртуальні орбіталі. Це не значить, що електрони насправді туди
			переходять — просто
			ми враховуємо можливість такого стану, щоб покращити опис основного стану.

			\bigskip

			Такі стани дозволяють електронам бути далі один від одного, і саме це — фізичний зміст
			кореляції руху
			електронів. У математичному сенсі ми комбінуємо (зважено додаємо) ці збуджені конфігурації
			до
			основної, і таким чином отримаємо точнішу хвильову функцію та меншу енергію системи.
		\end{block}
	\end{onlyenv}
	\framesubtitle<4>{Ілюстрація методу}
	\begin{onlyenv}<4>
		\begin{center}
			\input{tikz/CI.tikz}
		\end{center}
		\begin{center}
			Формування збуджених гамільтоніанів шляхом переміщення електронів з зайнятих орбіталей в детермінантах Слейтера на віртуальні (\alert{промотування}).
			% При формуванні набору $\{\Phi_k\}_{1,\ldots, n}$ для складних молекул часто \alert{обмежуються одно- та двократно-збудженими визначниками} по відношенню до $\Phi_{0}$ ({\scriptsize правило Кондона-Слейтера}). У такому варіанті метод називається ({\scriptsize\color{blue} CISD, Cl with single and double excitations}).
		\end{center}
	\end{onlyenv}

	\framesubtitle<5>{Енергія кореляції}
	\begin{onlyenv}<5>
		Середнє значення енергії, обчислене з хвильовою функцією
		\[
			\Phi = C_0 \Phi_{0} + \sum_{k = 1}^{n} C_k\Phi_k, \quad C_0 \approx 1,
		\]
		визначається співвідношенням
		\begin{multline*}\label{}
			E_{CI} = \bracket<\Phi_{0} + \sum_{k = 1}^{n} C_k\Phi_k|\hat{H}|\Phi_{0} + \sum_{l = 1}^{n} C_P\Phi_l> = \\
			= \bracket<\Phi_{0}|\hat{H}|\Phi_{0}> + \bracket<\sum_{k = 1}^{n} C_k\Phi_k|\hat{H}|\sum_{l = 1}^{n} C_l\Phi_l> \approx E_{HF} + \Delta E.
		\end{multline*}
		$E_{HF} = \bracket<\Phi_{0}|\hat{H}|\Phi_{0}>$. Добавка до Хартрі-Фоківської енергії $\Delta E$ і є енергією кореляції $E_\text{кор}$.
	\end{onlyenv}
	\begin{onlyenv}<6>
		\framesubtitle<6>{Як розв'язується задача?}
		%\begin{multline}
		%E_{CI} = \left<\Phi_{0} + \sum_{k=1}^{n} C_k \Phi_k \middle| \hat{H} \middle| \Phi_{0} +
		%\sum_{l=1}^{n} C_l \Phi_l \right> = \\
		%= \underbrace{\left<\Phi_{0}|\hat{H}|\Phi_{0}\right>}{E{HF}} + \underbrace{2 \sum_{k=1}^{n} C_k
		%\left<\Phi_{0}|\hat{H}|\Phi_k\right>}{\text{=0 (за теоремою Бріллюена)}} + \\ +
		%\underbrace{\sum{k,l=1}^{n}
		%C_k C_l \left<\Phi_k|\hat{H}|\Phi_l\right>}{\Delta E{\text{корр.}}}
		%\end{multline}

		\[
			\Phi = C_0 \Phi_{0} + \sum_{k = 1}^{n} C_k\Phi_k, \quad C_0 \approx 1,
		\]
		Застосовуючи варіаційний принцип, отримуємо набір рівнянь:
		\[
			\sum_{k = 0}^n C_k(H_{ik} - E\delta_{ik}) = 0, \quad H_{ik} = \bracket<\Phi_i|\hat{H}|\Phi_k>.
		\]
		\begin{block}{}\justifying
			Матричні елементи  між основним і одноразово збудженими електронними
			конфігураціями дорівнюють нулю $\bracket<\Phi_0|\hat{H}|\Phi_1> = 0$
			(\textcolor{blue}{теорема Бріллюена}). Тобто, обраний одноразово збуджений детермінант
			стан не взаємодіє із основним станом.
		\end{block}
	\end{onlyenv}
\end{frame}
%============================================================================

% ============================== Слайд ## ===================================
\begin{frame}{Зоопарк методів конфігураційної взаємодії}{}\scriptsize
	\begin{enumerate}
		\item  \alert{\texttt{CIS}}, <<S>> означає <<\alert{Singles}>> (<<\alert{одинаки}>>). У цьому
		      варіанті
		      враховуютьсяь
		      тільки $\Phi_0$ з Хартрі-Фока і його одноелектронні збудження $\Phi^{a}_i$.
		      Природно, енергія основного стану при цьому
		      не змінюється (теорема Бріллюена), але одноразово збуджені його версії дають оцінки для
		      збуджених станів, адже один відносно одного визначники можуть бути багаторазово збудженими.
		\item \alert{\texttt{CID}}, додана <<D>> позначає <<\alert{Doubles}>> (<<\alert{подвійні}>>).
		      У цьому
		      варіанті
		      те у використовуються двоелектронні збудження $\Phi^{ab}_{ij}$, які змінюють енергію
		      основного стану. Ну і
		      дають деякі збудження на додачу.
		\item \alert{\texttt{CISD}} (<<\alert{CI with Singles and Doubles}>>). Дає як більш точний
		      основний стан, так і
		      збуджені.
		\item \alert{\texttt{CISDT}}, де <<T>> --- це <<Triples>> (<<потрійні>>). Тепер ще в компанію
		      до CISD
		      прийдуть потрійні збудження $\Phi^{abc}_{ijk}$.
		\item В методі повної конфігураційної взаємодії (\alert{\texttt{Full CI}}) враховуються всі можливі
		      розселення всіх $N$ електронів системи за всіма наявними орбіталями системи. Для синглетного стану $S
			      = 0$ число детермінантів:
		      \begin{equation*}\label{}
			      n = \frac{M!(M+1)!}{\left(\frac12 N\right)! \left(\frac12 N +
				      1\right)!\left(M - \frac12N\right)!\left(M - \frac12N + 1\right)}.
		      \end{equation*}%
		      Для будь-якої реальної системи це означає врахування величезної кількості детермінантів, тому метод
		      \texttt{Full CI} застосовується, як правило, \alert{тільки для простих систем}.
	\end{enumerate}
\end{frame}
% ===========================================================================

% ============================== Слайд ## ===================================
\begin{frame}{Розмірна екстенсивність енергії}{}
	\begin{block}{}\justifying
		\alert{Розмірна екстенсивність енергії} термін, який  означає, що при розпаді системи
		на невзаємодіючиі фрагменти повна енергія повинна дорівнювати сумі
		енергій складових частин системи:
		\begin{equation*}
			E = E_A + E_B.
		\end{equation*}

		\begin{block}{}\justifying
			В обмеженому методі конфігураційної взаємодії (CISD, CISDT та ін.) елементарна вимога
			розмірної екстенсивності не
			виконується. На практиці це означає зокрема, що неправильно оцінюється дисоціаційна межа.
			\bigskip

			Справа в тому, що  при розпаді молекули електрони продовжують бути збудженими, навіть якщо
			фрагменти віддаляються один від одного. Це означає, що взаємодії між електронами не розпадаються
			коректно, і це порушує принцип екстенсивності.
		\end{block}

	\end{block}
\end{frame}
% ===========================================================================

% ============================== Слайд ## ===================================
\begin{frame}[fragile]{Багатоконфігураційні методи}{MC SFC}
	\begin{onlyenv}<1>
		\begin{alertblock}{}\justifying
			Ряд за конфігураціями в методі CI сходиться дуже повільно. Одна з основних причин цього полягає в тому, що віртуальні молекулярні орбіталі не оптимальні.
		\end{alertblock}
		\begin{block}{}\justifying
			Один зі шляхів подолання цих труднощів --- комбінування методу
			CI з методом HF. Полягає цей метод в одночасній оптимізації як
			коефіцієнтів $C_i$ у розкладанні за конфігураціями хвильової функції,
			так і спін-орбіталей, з яких будуються детермінанти конфігурацій.
		\end{block}

		\begin{block}{}\justifying
			У цьому методі розв'язуються дві
			пов'язані системи рівнянь: на відшукання коефіцієнтів розкладання
			за конфігураціями і на відшукання коефіцієнтів розкладання
			одноелектронних МО за базисними функціями. Час розрахунків і
			необхідні ресурси, звісно, при цьому великі.
		\end{block}

	\end{onlyenv}
	\begin{onlyenv}<2>
		\begin{block}{}
			Алгоритм класичного метода MC SCF:
			\begin{enumerate}
				\item береться скінченне CI-розширення (детермінанти Слейтера та орбіталі для їх побудови фіксовані);
				\item обчислюються коефіцієнти при визначниках $C_k$ (орбіталі не змінюються);
				\item варіюються коефіцієнти LCAO $c_k$на орбіталях при фіксованих коефіцієнтах $C_k$, щоб отримати найкращі молекулярних орбіталі;
				\item повертаються до пункту 1 до досягнення самоузгодженості.
			\end{enumerate}
		\end{block}
	\end{onlyenv}
	\begin{onlyenv}<3>
		\begin{block}{}\justifying
			Одним із варіантів методу MC SCF, який останнім часом став досить широко використовуватися,
			є метод повного MC SCF активних орбіталей (CAS SCF, complete active space). Уперше цей метод запропоновано в 1979 р. М. Роббом зі співавторами. У методі CAS SCF весь простір спін-орбіталей  розбивається на три групи:
			\begin{enumerate}
				\item Орбіталі, які у всіх конфігураціях зайняті двома  електронами --- неактивні орбіталі.
				\item Орбіталі активного простору --- це кілька верхніх заповнених в основній конфігурації орбіталей і кілька нижніх віртуальних орбіталей методу HF.
				\item Третя група орбіталей --- це віртуальні орбіталі, які не використовуються при побудові конфігурацій.
			\end{enumerate}
		\end{block}
	\end{onlyenv}
	\framesubtitle<4>{Ілюстрація методу}
	\begin{onlyenv}<4>
		\begin{center}
			\input{tikz/CASSCF.tikz}
		\end{center}
	\end{onlyenv}
	\begin{onlyenv}<5>
		\begin{block}{}\justifying
			Під час проведення CAS SCF розрахунків необхідно задати число активних
			орбіталей \alert{\texttt{Norb}} і число електронів \alert{\texttt{Nel}}, які всіма можливими
			способами будуть по цих орбіталях <<розсаджені>> при побудові
			конфігурацій.
			%Є також можливість вибрати номери орбіталей, які будуть віднесені до активного
			простору.
		\end{block}



	\begin{block}{}
		Збуджені електронні стани атома/молекули --- розв'язки (\alert{\texttt{roots}}) рівняння
		Шредінґера для функцій $m > 0$:
		\begin{equation*}
			\tcbhighmath{\hat{H}_e(\vec{R})\Phi_{\color{red}n}(\vxi\,|\,\vec{R}) =
			E_{e_{\color{red}n}}(\vec{R})\Phi_{\color{red}n}(\vxi\,|\,\vec{R})}
		\end{equation*}
	\end{block}



	\end{onlyenv}
	\begin{onlyenv}<6>
		Сканування геометрії молекули \ce{H2} методом CASSCF
		\begin{minted}[
        autogobble,
        fontsize=\scriptsize,
        ]
        {ruby}
! RHF SVP
%casscf
    Nel 2    # The number of electrons
    Norb 2   # The number of orbitals
    Nroots 1 # The number 0f excited state(s). 1 - for ground state
end
%paras
    R= 0.5,3.5,25
end

* int 0 1
   H     0     0     0        0.00000        0.00000        0.00000
   H     1     0     0        {R}            0.00000        0.00000
*
        \end{minted}
	\end{onlyenv}
	\begin{onlyenv}<7>
		\begin{center}
			\input{tikz/energy.tikz}
		\end{center}
		\begin{block}{}
			Енергія дисоціації молекули \ce{H2}: $E = 1.16 - 1 = 0.16$~Eh.
		\end{block}
	\end{onlyenv}
\end{frame}
% ===========================================================================

% ============================== Слайд ## ===================================
\begin{frame}{Метод зв'язаних кластерів (Coupled Clusters, CC)}
	\begin{onlyenv}<1>
		\begin{block}{}\justifying
			Метод зв'язаних кластерів (\texttt{Coupled Clusters}, \texttt{СС}) можна розглядати як
			різновид
			методу конфігураційної взаємодії.

			\medskip
			У методі \texttt{CC} багатоелектронну систему
			молекули розбивають на менші підсистеми, тобто на групи (кластери)
			електронів. Кожен електрон взаємодіє з кластером інших електронів, причому сам
			він входить у кілька таких кластерів. Кластер може складатися з одного
			електрона (одноелектронний кластер), з електронних пар
			(двохелектронний кластер) тощо.

			\bigskip

			\alert{Метод автоматично враховує, що електрони в різних частинах системи не впливають один на одного,
				якщо вони далеко із-за експоненційного спадання хвильових
				функцій з відстанню.}
		\end{block}
	\end{onlyenv}
	\begin{onlyenv}<2>
		\begin{block}{}\justifying
			Хвильову функцію молекули можна подати у вигляді кластерного оператора, що діє на хвильову функцію основного стану $|\Phi_0\rangle$:
			\begin{equation*}
				|\Psi\rangle = e^{\hat{T}} |\Phi_0\rangle,
			\end{equation*}
			де \( \hat{T} = \hat{T}_1 + \hat{T}_2 + \hat{T}_3 + \ldots + \hat{T}_n \) --- оператор кластеризації,
			$\hat{T}_1$, $\hat{T}_2$, \ldots , $\hat{T}_n$ --- кластерні оператори першого, другого, ..., $n$-ого порядків.

			\begin{equation*}
				\hat{T}_1 = \sum_{ia} t_i^a \hat{a}^\dagger_a \hat{a}_i, \quad
				\hat{T}_2 = \frac{1}{4} \sum_{ijab} t_{ij}^{ab} \hat{a}^\dagger_a \hat{a}^\dagger_b \hat{a}_j \hat{a}_i \ldots
			\end{equation*}
			Тут $i, j, k, \ldots$ позначають орбіталі, зайняті електронами, а $a, b, c, \ldots$ --- вакантні орбіталі. $t_i^a$, $t_{ij}^{ab}$, \ldots --- кластерні амплітуди які визначаються при ітераційних розрахунках.
		\end{block}
		\begin{alertblock}{}\justifying
			Важливою перевагою методу зв’язаних кластерів, зокрема методу CCSD, є те, що він
			задовольняє вимозі розмірної екстенсивності.
		\end{alertblock}
	\end{onlyenv}
\end{frame}
% ===========================================================================

% ============================== Слайд ## ===================================
%\begin{frame}{Пост-Хартрі-Фоківські методи}{}\tiny
%       \begin{tblr}{
%        colspec = {Q[0.3\linewidth, c, m]Q[0.3\linewidth, c, m]Q[0.3\linewidth, c, m]},
%        hlines,
%        vlines,
%        }
%
%        Метод & Опис & Застосування \\
%
%         CIS (Configuration Interaction Singles) & Враховує тільки збуджені одноелектронні стани. & Расчеты возбужденных состояний молекул. \\

%        MP2 (Møller-Plesset Perturbation Theory) & Учитывает корреляции двухэлектронных возмущений во втором порядке теории возмущений. & Расчеты энергии и структуры молекул. \\
%
%        MP3 (Møller-Plesset Perturbation Theory to Third Order) & Учитывает корреляции двухэлектронных возмущений в третьем порядке теории возмущений. & Расчеты энергии и структуры молекул. \\
%
%        MP4 (Møller-Plesset Perturbation Theory to Fourth Order) & Учитывает корреляции двухэлектронных возмущений в четвертом порядке теории возмущений. & Расчеты энергии и структуры молекул. \\
%
%        CIS(D) (Configuration Interaction with Singles and Doubles) & Дополнительно учитывает корреляции двухэлектронных возмущений. & Расчеты возбужденных состояний молекул. \\
%
%        CCSD(T) (Coupled Cluster with Singles, Doubles, and perturbatively treated Triples) & Дополнительно учитывает корреляции трехэлектронных возмущений с помощью поправки третьего порядка.  & Расчеты энергии и структуры молекул, включая системы с сильными корреляциями. \\
%
%        CASSCF (Complete Active Space Self-Consistent Field) & Полностью учитывает корреляцию между электронами в рамках активного пространства.  & Исследование электронных переходов и реакций. \\
%
%        CASPT2 (Complete Active Space Second-Order Perturbation Theory) & Представляет собой комбинацию CASSCF и второго порядка теории возмущений.  & Расчеты энергий основного и возбужденных состояний, включая состояния с сильными корреляциями. \\
%
%        CCSDT (Coupled Cluster with Singles, Doubles, and Triples) & Учитывает корреляции одноэлектронных, двухэлектронных и трехэлектронных возмущений. & Расчеты энергии и структуры молекул, включая системы с сильными корреляциями. \\
%
%        CCSDTQ (Coupled Cluster with Singles, Doubles, Triples, and Quadruples) & Учитывает корреляции одноэлектронных, двухэлектронных, трехэлектронных и четырехэлектронных возмущений. & Расчеты энергии и структуры молекул, включая системы с сильными корреляциями. \\

%    \end{tblr}
%\end{frame}
% ===========================================================================

% ============================== Слайд ## ===================================
\begin{frame}{Розмірна екстенсивність енергії методів \texttt{CI} та \texttt{CC}}{}
	\begin{block}{}
		Якщо система складається з двох невзаємодіючих фрагментів (молекул) $A$ і $B$, то повна хвильова
		функція методу пов'язаних кластерів є добутком функцій СС цих молекул:
		\begin{multline*}
			\left| \Psi_{CC} \right\rangle = e^{\hat{T}} \left| \Phi_0 \right\rangle = e^{\hat{T}_A + \hat{T}_B}
			\left| \Phi_0 \right\rangle^A \left| \Phi_0 \right\rangle^B = e^{\hat{T}_A} \left| \Phi_0
			\right\rangle^A e^{\hat{T}_B} \left| \Phi_0 \right\rangle^B = \\
			= \left| \Psi_{CC} \right\rangle^A \left| \Psi_{CC} \right\rangle^B,
		\end{multline*}
		а енергія дорівнює сумі енергій невзаємодіючих фрагментів.

		\bigskip

		Функція методу CI в цьому випадку має такий вигляд:
		\begin{equation*}
			|\Psi_{C1}\rangle = (1 + \hat{C}_A + \hat{C}_B) |\Phi_0\rangle^A |\Phi_0\rangle^B,
		\end{equation*}
		і енергія не дорівнює сумі енергій невзаємодіючих
		фрагментів, що не взаємодіють.

	\end{block}
\end{frame}
% ===========================================================================

%============================================================================
\begin{frame}{Діаграма Попла}{}
	{\scriptsize \fullcite{Popl:2002}}
	\begin{center}
		%            \includegraphics[width=\linewidth]{Pople_diagram_reverse_final.pdf}
		\begin{tikzpicture}
			\pgfmathsetmacro{\x}{7}
			\pgfmathsetmacro{\y}{6}
			\draw[-{Latex[scale=2]}, thick, gray] (0,0) -- node[sloped, anchor=north, font=\scriptsize] {кількість базисних функцій}++(0,\y);
			\draw[-{Latex[scale=2]}, thick, gray] (0,0) -- node[above, font=\scriptsize] {врахування кореляції} ++(\x,0);
			\node[draw, dashed, text width=3cm, font=\scriptsize, align=center, blue] (S) at  (\x, \y) {Точний розв'язок\\ рівняння Шредінгера};
			%    \draw [thick, -{Latex[scale=2]}] (0,0) --
			%            node[sloped, above, font=\scriptsize, red] {зростання часу обчислення}
			%            node[sloped, below, font=\scriptsize,] {зростання точності}
			%            (S.south west);
			\connect{0,0}{S.south west}{single arrow, top color=red, bottom color=blue};
			\path (0,0) --
			node[sloped, above, font=\scriptsize, red] {зростання часу обчислення}
			node[sloped, below, font=\scriptsize, blue] {зростання точності}
			(S.south west);

			\node[left, font=\scriptsize] at (0,0.5) {minimal basis set};
			\node[left, font=\scriptsize] at (0,1) {6-31G(d)};
			\node[left, font=\scriptsize] at (0,1.5) {6-31+G(d,p)};
			\node[left, font=\scriptsize] at (0,2) {6-311++G(2df,pd)};
			\node[left, font=\scriptsize] at (0,2.5) {$\vdots$};
			\node[left, font=\scriptsize] at (0,3) {(aug)-cc-pVDZ};
			\node[left, font=\scriptsize] at (0,3.5) {(aug)-cc-pVTZ};
			\node[left, font=\scriptsize] at (0,4) {(aug)-cc-pVQZ};
			\node[left, font=\scriptsize] at (0,4.5) {$\vdots$};
			\node[left, font=\scriptsize, text width=50pt] at (0,{\y}) {Хартрі-фоківський\\ ліміт};
			\node[left, font=\scriptsize, rotate=90] at (0.5, 0) {HF};
			\node[left, font=\scriptsize, rotate=90] at (1, 0) {MP2};
			\node[left, font=\scriptsize, rotate=90] at (1.5, 0) {MP4};
			\node[left, font=\scriptsize, rotate=90] at (2, 0) {CISD};
			\node[left, font=\scriptsize, rotate=90] at (2.5, 0) {CCSD};
			\node[below, font=\scriptsize] at (3, 0) {$\cdots$};
			\node[left, font=\scriptsize, rotate=90] at (\x, 0) {Full CI};
		\end{tikzpicture}
	\end{center}
\end{frame}
%============================================================================

%============================================================================
%\begin{frame}{Рівняння Хартрі-Фока}{Алгоритм розв'язку для атома гелію}\footnotesize
%	Базисні функції
%	\begin{equation*}\label{}
%		\chi_1 = \frac1{\sqrt{4\pi}}2\zeta_1^{3/2}e^{-\zeta_1r}, \quad \chi_2 = \frac1{\sqrt{4\pi}}2\zeta_1^{3/2}e^{-\zeta_2r}, \zeta_1 = 1.45, \quad \zeta_2 = 2.91.
%	\end{equation*}
%	\begin{overprint}
%		\onslide<1>
%		Компоненти матриці перекривання
%		\begin{equation*}\label{}
%			S_{11} = S_{22} = 1, \quad S_{12} = S_{21} = \frac{8\zeta_1^{3/2} \zeta_2^{3/2}}{(\zeta_1 + \zeta_2)^3} = 0.8366
%		\end{equation*}
%
%		Компоненти $\opbracket{\chi_p}{\hat{h}}{\chi_q}$
%		\begin{align*}\label{}
%			\opbracket{\chi_1}{\hat{h}}{\chi_1} = -\frac12\zeta_1^{3/2} + (\zeta_1 - 2)\zeta_1 = -1.8488, \quad \opbracket{\chi_2}{\hat{h}}{\chi_2} = -1.5860 \\
%			\opbracket{\chi_1}{\hat{h}}{\chi_2} = \opbracket{\chi_2}{\hat{h}}{\chi_1} = \frac{\zeta_1^{3/2}\zeta_2^{3/2}(4\zeta_1\zeta_2 - 8(\zeta_1 + \zeta_2))}{(\zeta_1 + \zeta_2)^3} = -1.8826.
%		\end{align*}
%		\onslide<2>
%		Кулонівські та обмінні інтеграли
%		\begin{align*}\label{}
%			(11|11) & = \frac58\zeta_1 = 0.9062, \quad (22|22) = \frac58\zeta_2 = 1.8188,                                                           \\
%			(11|22) & = (22|11) = (\zeta_1^4\zeta_2 + 4\zeta_1^3\zeta_2^2 + \zeta_1\zeta_2^4 + 4\zeta_1^2\zeta_2^3)/(\zeta_1 + \zeta_2)^4 = 1.1826, \\
%			(12|12) & = (21|12) = (12|21) = (21|21) = 20\zeta_1^3\zeta_2^3/(\zeta_1 + \zeta_2)^5 = 0.9535,                                          \\
%			(11|12) & = (11|21) = (12|11) = (21|11) =                                                                                               \\ &= \frac{16\zeta_1^{9/2}\zeta_2^{3/2}}{(3\zeta_1 + \zeta_2)^4}\left[\frac{12\zeta_1 + 8\zeta_2}{(\zeta_1 + \zeta_2)^2} + \frac{9\zeta_1 + \zeta_2}{2\zeta_1^2}\right] = 0.9033,\\
%			(12|22) & = (22|12) = (21|22) = (22|21) = 1.2980.
%		\end{align*}
%		\onslide<3>
%		Для вибору початкових коефіцієнтів візьмемо співвідношення $c_{11}/c_{21} \approx 2 = k$ . \\~\\
%		Умова нормування $\int |\phi_1|^2 dv = \int (c_{11}\chi_1 + c_{21}\chi_2)^2 dv = 1$ дає співвідношення $c_{21} = \sqrt{1 + k^2 + 2kS_{12}} \approx  0.3461$, $c_{11} = 0.6922$.\\~\\
%		Елементи матриці густини:
%		\begin{align*}\label{}
%			P_{11} = 2c_{11}c_{11} \approx 0.9583, \quad P_{12} = 2c_{11}c_{12} \approx 0.4791, \\
%			P_{21} = 2c_{21}c_{11} \approx 0.4791, \quad P_{22} = 2c_{21}c_{21} \approx 0.2396.
%		\end{align*}
%		\onslide<4>
%		Елементи матриці Фока:
%		\begin{align*}\label{}
%			F_{11} & = h_{11} + \frac12P_{11}(11|11) +  P_{12}(11|12) +P_{22}\left[(11|22) - \frac12(12|21)\right],              \\
%			F_{12} & = h_{12}+ \frac12P_{11}(12|11) + P_{12}\left[\frac32(12|12) - \frac12(11|22)\right] + \frac12P_{22}(12|22), \\
%			F_{22} & = F_{12},                                                                                                   \\
%			F_{22} & = h_{22} + P_{11}\left[(22|11) - \frac12(21|12)\right] + P_{12}(22|12) + \frac12P_{22}(22|22).
%		\end{align*}
%		\onslide<5>
%		Елементи матриці Фока:
%		\begin{align*}\label{}
%			F_{11} & = -1.8448 + 0.4531P_{11} +0.9033P_{12} + 0.7058P_{22},          \\
%			F_{12} & = F_{12} = -1.8826 + 0.45165P_{11} + 0.8391P_12 + 0.6490P_{22}, \\
%			F_{22} & = -1.5860 + 0.7058P_{11} + 1.2980P_{12} + 0.9094P_{22}.
%		\end{align*}
%		\begin{equation*}\label{}
%			F_{11} \approx -0.813, \quad F_{12} = F_{12} \approx -0.892, \quad F_{22} \approx -0.070\\
%		\end{equation*}
%		\onslide<6>
%		Розв'яжемо секулярне рівняння $\mathrm{det}(F_{pq} - S_{pq}\varepsilon_i) = 0$
%		\begin{equation*}\label{}
%			\left|
%			\begin{matrix}
%				-0.813 - \varepsilon_i       & -0.892 - 0.8366\varepsilon_i \\
%				-0.892 - 0.8366\varepsilon_i & -0.070-\varepsilon_1
%			\end{matrix}
%			\right| \approx 0.
%		\end{equation*}
%		\begin{equation*}\label{}
%			0.3001\varepsilon_1^2 - 0.6095\varepsilon_i - 0.739 \approx 0
%		\end{equation*}
%		\begin{equation*}\label{}
%			\varepsilon_1 \approx -0.854, \quad \varepsilon_2 \approx 2.885
%		\end{equation*}
%		\onslide<7>
%		Вибираємо корінь з меншою енергією і підставляємо його в рівняння Хартрі-Фока-Рутаана з  $p = 2$.
%		\begin{equation*}\label{}
%			c_{11}(F_{21} - \varepsilon_1S_{21}) + c_{21}(F_{22} - \varepsilon_1S_{22}) \approx 0.
%		\end{equation*}
%		\begin{equation*}\label{}
%			-0.1775 c_{11}  + 0.784 c_{21} \approx 0.
%		\end{equation*}
%		\begin{equation*}\label{}
%			c_{11}/c_{21} \approx 4.42.
%		\end{equation*}
%		Отримуємо поправлені коефіцієнти $c_{12} = 0.189$, $c_{11} = 0.836$.
%	\end{overprint}
%\end{frame}
%============================================================================

\end{document}
