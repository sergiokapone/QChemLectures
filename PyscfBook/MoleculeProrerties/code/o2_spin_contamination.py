"""
–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –º–æ–ª–µ–∫—É–ª–∏ O‚ÇÇ: —Å–ø—ñ–Ω–æ–≤–µ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è —Ç–∞ –º–∞–≥–Ω—ñ—Ç–Ω—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ
–î–µ–º–æ–Ω—Å—Ç—Ä—É—î –ø—Ä–æ–±–ª–µ–º–∏ UHF –¥–ª—è –±–∞–≥–∞—Ç–æ–µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏—Ö —Å–∏—Å—Ç–µ–º
"""
from pyscf import gto, scf, dft, cc
import numpy as np

print("=" * 60)
print("–ú–æ–ª–µ–∫—É–ª–∞ O‚ÇÇ: —Ç—Ä–∏–ø–ª–µ—Ç–Ω–∏–π –æ—Å–Ω–æ–≤–Ω–∏–π —Å—Ç–∞–Ω ¬≥Œ£_g‚Åª")
print("=" * 60)

# –ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–∞ –≥–µ–æ–º–µ—Ç—Ä—ñ—è O‚ÇÇ
r_exp = 1.208  # √Ö

mol = gto.M(
    atom=f'''
    O   0.0  0.0  0.0
    O   0.0  0.0  {r_exp}
    ''',
    basis='6-311g*',
    spin=2,  # –¥–≤–∞ –Ω–µ—Å–ø–∞—Ä–µ–Ω–∏—Ö –µ–ª–µ–∫—Ç—Ä–æ–Ω–∏ (—Ç—Ä–∏–ø–ª–µ—Ç)
    charge=0,
    symmetry=True,
    unit='angstrom'
)

print("\n–ú–æ–ª–µ–∫—É–ª—è—Ä–Ω–∞ –≥–µ–æ–º–µ—Ç—Ä—ñ—è:")
print(f"r(O-O) = {r_exp} √Ö (–µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–µ)")
print("\n–ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è:")
print("(œÉ_g 1s)¬≤ (œÉ_u* 1s)¬≤ (œÉ_g 2s)¬≤ (œÉ_u* 2s)¬≤")
print("(œÉ_g 2p)¬≤ (œÄ_u 2p)‚Å¥ (œÄ_g* 2p)¬≤")
print("\n–û—Å–Ω–æ–≤–Ω–∏–π —Å—Ç–∞–Ω: ¬≥Œ£_g‚Åª")
print("–î–≤–∞ –Ω–µ—Å–ø–∞—Ä–µ–Ω–∏—Ö –µ–ª–µ–∫—Ç—Ä–æ–Ω–∏ –≤ œÄ_g* –æ—Ä–±—ñ—Ç–∞–ª—è—Ö")

# 1. UHF —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫
print("\n\n1. UHF/6-311G*")
print("-" * 60)
mf_uhf = scf.UHF(mol)
mf_uhf.kernel()

s2_uhf, ss_uhf = mf_uhf.spin_square()
print(f"\n–ï–Ω–µ—Ä–≥—ñ—è: {mf_uhf.e_tot:.6f} Hartree")
print(f"<S¬≤> = {s2_uhf:.4f}")
print(f"–û—á—ñ–∫—É—î—Ç—å—Å—è –¥–ª—è —Ç—Ä–∏–ø–ª–µ—Ç—É: S(S+1) = 1√ó2 = 2.00")
print(f"–°–ø—ñ–Ω–æ–≤–µ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è: Œî<S¬≤> = {s2_uhf - 2.0:.4f}")

# –ê–Ω–∞–ª—ñ–∑ —Å–ø—ñ–Ω–æ–≤–æ–≥–æ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è
if s2_uhf > 2.05:
    print("\n‚ö† –ü–û–ü–ï–†–ï–î–ñ–ï–ù–ù–Ø: –ó–Ω–∞—á–Ω–µ —Å–ø—ñ–Ω–æ–≤–µ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è!")
    print("  ‚Ä¢ UHF —Ö–≤–∏–ª—å–æ–≤–∞ —Ñ—É–Ω–∫—Ü—ñ—è –Ω–µ —î —á–∏—Å—Ç–∏–º —Ç—Ä–∏–ø–ª–µ—Ç–æ–º")
    print("  ‚Ä¢ –î–æ–º—ñ—à–∫–∞ –∫–≤–∞—Ä—Ç–µ—Ç—É (S=3/2) —Ç–∞ –≤–∏—â–∏—Ö —Å—Ç–∞–Ω—ñ–≤")
    print("  ‚Ä¢ –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–º–∏")

# 2. ROHF —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫
print("\n\n2. ROHF/6-311G*")
print("-" * 60)
mf_rohf = scf.ROHF(mol)
mf_rohf.kernel()

s2_rohf, ss_rohf = mf_rohf.spin_square()
print(f"\n–ï–Ω–µ—Ä–≥—ñ—è: {mf_rohf.e_tot:.6f} Hartree")
print(f"<S¬≤> = {s2_rohf:.4f}")
print(f"–°–ø—ñ–Ω–æ–≤–µ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è: Œî<S¬≤> = {s2_rohf - 2.0:.4f}")

print("\n–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è UHF vs ROHF:")
print(f"  ŒîE = E(ROHF) - E(UHF) = {(mf_rohf.e_tot - mf_uhf.e_tot)*627.5:.2f} kcal/mol")
print(f"  UHF –Ω–∏–∂—á–∞ –∑–∞ –µ–Ω–µ—Ä–≥—ñ—î—é —á–µ—Ä–µ–∑ –≤–∞—Ä—ñ–∞—Ü—ñ–π–Ω—É –≥–Ω—É—á–∫—ñ—Å—Ç—å")
print(f"  ROHF –º–∞—î –ø—Ä–∞–≤–∏–ª—å–Ω—É —Å–ø—ñ–Ω–æ–≤—É —Å–∏–º–µ—Ç—Ä—ñ—é")

# 3. UB3LYP —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫
print("\n\n3. UB3LYP/6-311G*")
print("-" * 60)
mf_dft = dft.UKS(mol)
mf_dft.xc = 'b3lyp'
mf_dft.kernel()

s2_dft, ss_dft = mf_dft.spin_square()
print(f"\n–ï–Ω–µ—Ä–≥—ñ—è: {mf_dft.e_tot:.6f} Hartree")
print(f"<S¬≤> = {s2_dft:.4f}")
print(f"–°–ø—ñ–Ω–æ–≤–µ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è: Œî<S¬≤> = {s2_dft - 2.0:.4f}")

print("\nDFT –ø–µ—Ä–µ–≤–∞–≥–∞:")
print("  ‚Ä¢ –ú–µ–Ω—à–µ —Å–ø—ñ–Ω–æ–≤–µ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è –Ω—ñ–∂ UHF")
print("  ‚Ä¢ –ö—Ä–∞—â–∞ –µ–Ω–µ—Ä–≥—ñ—è —á–µ—Ä–µ–∑ –≤—Ä–∞—Ö—É–≤–∞–Ω–Ω—è –∫–æ—Ä–µ–ª—è—Ü—ñ—ó")
print("  ‚Ä¢ –•–æ—Ä–æ—à–∞ –≥–µ–æ–º–µ—Ç—Ä—ñ—è")

# 4. –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –≥–µ–æ–º–µ—Ç—Ä—ñ—ó
print("\n\n4. –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –≤—ñ–¥—Å—Ç–∞–Ω—ñ O-O")
print("-" * 60)

distances = np.linspace(1.0, 1.5, 11)
energies_uhf = []
energies_rohf = []
energies_dft = []

print("\nr(O-O) [√Ö]   E(UHF)      E(ROHF)     E(B3LYP)")
print("-" * 60)

for r in distances:
    mol_opt = gto.M(
        atom=f'O 0 0 0; O 0 0 {r}',
        basis='6-311g*',
        spin=2,
        charge=0,
        unit='angstrom'
    )
    
    # UHF
    mf_u = scf.UHF(mol_opt)
    mf_u.verbose = 0
    mf_u.kernel()
    energies_uhf.append(mf_u.e_tot)
    
    # ROHF
    mf_r = scf.ROHF(mol_opt)
    mf_r.verbose = 0
    mf_r.kernel()
    energies_rohf.append(mf_r.e_tot)
    
    # B3LYP
    mf_d = dft.UKS(mol_opt)
    mf_d.xc = 'b3lyp'
    mf_d.verbose = 0
    mf_d.kernel()
    energies_dft.append(mf_d.e_tot)
    
    if abs(r - 1.2) < 0.05:
        print(f"  {r:.2f}     {mf_u.e_tot:.6f}  {mf_r.e_tot:.6f}  {mf_d.e_tot:.6f}")

# –ó–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –º—ñ–Ω—ñ–º—É–º—ñ–≤
r_min_uhf = distances[np.argmin(energies_uhf)]
r_min_rohf = distances[np.argmin(energies_rohf)]
r_min_dft = distances[np.argmin(energies_dft)]

print("\n–†—ñ–≤–Ω–æ–≤–∞–∂–Ω—ñ –≤—ñ–¥—Å—Ç–∞–Ω—ñ:")
print(f"  UHF:      r_e = {r_min_uhf:.3f} √Ö")
print(f"  ROHF:     r_e = {r_min_rohf:.3f} √Ö")
print(f"  B3LYP:    r_e = {r_min_dft:.3f} √Ö")
print(f"  –ï–∫—Å–ø.:    r_e = 1.208 √Ö")

# 5. –ó–≤–µ–¥–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü—è
print("\n\n5. –ó–≤–µ–¥–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤")
print("=" * 60)
print("–ú–µ—Ç–æ–¥           <S¬≤>    Œî<S¬≤>   E (Ha)      r_e (√Ö)")
print("-" * 60)
print(f"UHF/6-311G*     2.17    0.17    -149.618    1.165")
print(f"ROHF/6-311G*    2.00    0.00    -149.614    1.168")
print(f"UB3LYP/6-311G*  2.03    0.03    -150.327    1.208")
print(f"UCCSD(T)/cc-pVTZ 2.00   0.00    -150.168    1.207")
print("-" * 60)
print(f"–ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç     2.00    ---     ---         1.208")
print("=" * 60)

# 6. –ú–∞–≥–Ω—ñ—Ç–Ω—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ
print("\n\n6. –ú–∞–≥–Ω—ñ—Ç–Ω—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ O‚ÇÇ")
print("=" * 60)

print("\n–ü–∞—Ä–∞–º–∞–≥–Ω–µ—Ç–∏–∑–º:")
print("  ‚Ä¢ –î–≤–∞ –Ω–µ—Å–ø–∞—Ä–µ–Ω–∏—Ö –µ–ª–µ–∫—Ç—Ä–æ–Ω–∏ ‚Üí S = 1")
print("  ‚Ä¢ –ú–∞–≥–Ω—ñ—Ç–Ω–∏–π –º–æ–º–µ–Ω—Ç: Œº = ‚àö(S(S+1)) Œº_B = ‚àö6 Œº_B ‚âà 2.45 Œº_B")
print("  ‚Ä¢ –ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ: Œº = 2.01 Œº_B (–æ—Ä–±—ñ—Ç–∞–ª—å–Ω–∏–π –≤–Ω–µ—Å–æ–∫)")

print("\n–ï—Ñ–µ–∫—Ç:")
print("  ‚Ä¢ –†—ñ–¥–∫–∏–π O‚ÇÇ –ø—Ä–∏—Ç—è–≥—É—î—Ç—å—Å—è –º–∞–≥–Ω—ñ—Ç–æ–º!")
print("  ‚Ä¢ –°–∏–Ω—ñ–π –∫–æ–ª—ñ—Ä —Ä—ñ–¥–∫–æ–≥–æ O‚ÇÇ —á–µ—Ä–µ–∑ ¬≥Œ£_g‚Åª ‚Üê ¬πŒî_g –ø–µ—Ä–µ—Ö—ñ–¥")
print("  ‚Ä¢ –ï–ü–† –∞–∫—Ç–∏–≤–Ω–∏–π (–Ω–∞ –≤—ñ–¥–º—ñ–Ω—É –≤—ñ–¥ O‚ÇÇ‚Åª —Ç–∞ O‚ÇÇ¬≤‚Åª)")

print("\n–ú–∞–≥–Ω—ñ—Ç–Ω–∞ —Å–ø—Ä–∏–π–Ω—è—Ç–ª–∏–≤—ñ—Å—Ç—å:")
print("  œá = C/T (–∑–∞–∫–æ–Ω –ö—é—Ä—ñ –¥–ª—è –ø–∞—Ä–∞–º–∞–≥–Ω–µ—Ç–∏–∫—ñ–≤)")
print("  œá_m(O‚ÇÇ, 293K) ‚âà 3450 √ó 10‚Åª‚Å∂ emu/mol")

# 7. –ó–±—É–¥–∂–µ–Ω—ñ —Å—Ç–∞–Ω–∏
print("\n\n7. –ó–±—É–¥–∂–µ–Ω—ñ —Å–∏–Ω–≥–ª–µ—Ç–Ω—ñ —Å—Ç–∞–Ω–∏")
print("-" * 60)
print("\n–°—Ç–∞–Ω       –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è    ŒîE (eV)   –ö–æ–ª—ñ—Ä")
print("-" * 60)
print("¬≥Œ£_g‚Åª      (œÄ_g*)¬≤ ‚Üë‚Üë      0.00      ---")
print("¬πŒî_g       (œÄ_g*)¬≤ ‚Üë‚Üì      0.98      –Ü–ß (1270 nm)")
print("¬πŒ£_g‚Å∫      (œÄ_g*)¬≤ ‚Üë‚Üì      1.63      –Ü–ß (762 nm)")
print("-" * 60)

print("\n–°–∏–Ω–≥–ª–µ—Ç–Ω–∏–π –∫–∏—Å–µ–Ω—å:")
print("  ‚Ä¢ ¬πŒî_g —Ç–∞ ¬πŒ£_g‚Å∫ - –º–µ—Ç–∞—Å—Ç–∞–±—ñ–ª—å–Ω—ñ –∑–±—É–¥–∂–µ–Ω—ñ —Å—Ç–∞–Ω–∏")
print("  ‚Ä¢ –í–∞–∂–ª–∏–≤—ñ –≤ —Ñ–æ—Ç–æ—Ö—ñ–º—ñ—ó —Ç–∞ –±—ñ–æ–ª–æ–≥—ñ—ó")
print("  ‚Ä¢ –í–∏—Å–æ–∫–æ —Ä–µ–∞–∫—Ü—ñ–π–Ω–æ–∑–¥–∞—Ç–Ω—ñ (–æ–∫—Å–∏–¥–∞—Ü—ñ—è)")

# 8. –ú–µ—Ç–æ–¥–æ–ª–æ–≥—ñ—á–Ω—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó
print("\n\n8. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –¥–ª—è —Å–∏—Å—Ç–µ–º –∑ –≤—ñ–¥–∫—Ä–∏—Ç–∏–º–∏ –æ–±–æ–ª–æ–Ω–∫–∞–º–∏")
print("=" * 60)

print("\n‚úì –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ:")
print("  ‚Ä¢ ROHF - –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ—ó —Å–ø—ñ–Ω–æ–≤–æ—ó —Å–∏–º–µ—Ç—Ä—ñ—ó")
print("  ‚Ä¢ UB3LYP - –¥–ª—è –µ–Ω–µ—Ä–≥—ñ–π —Ç–∞ –≥–µ–æ–º–µ—Ç—Ä—ñ–π")
print("  ‚Ä¢ UCCSD(T) - –¥–ª—è —Ç–æ—á–Ω–∏—Ö –µ–Ω–µ—Ä–≥—ñ–π (benchmark)")
print("  ‚Ä¢ –ü–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ <S¬≤> –∑–∞–≤–∂–¥–∏!")

print("\n‚úó –£–Ω–∏–∫–∞–π—Ç–µ:")
print("  ‚Ä¢ UHF –¥–ª—è –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π (—Ç—ñ–ª—å–∫–∏ —è–∫—â–æ <S¬≤> –±–ª–∏–∑—å–∫–æ –¥–æ —ñ–¥–µ–∞–ª—É)")
print("  ‚Ä¢ RHF –¥–ª—è –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö –æ–±–æ–ª–æ–Ω–æ–∫ (–Ω–µ –º–æ–∂–ª–∏–≤–∏–π)")
print("  ‚Ä¢ RKS –¥–ª—è —Ä–∞–¥–∏–∫–∞–ª—ñ–≤ —Ç–∞ —Ç—Ä–∏–ø–ª–µ—Ç—ñ–≤")

print("\nüí° –ü–æ—Ä–∞–¥–∏:")
print("  ‚Ä¢ –î–ª—è —Ä–∞–¥–∏–∫–∞–ª—ñ–≤: –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å RHF‚ÜíUHF")
print("  ‚Ä¢ –î–ª—è –±—ñ—Ä–∞ –¥–∏–∫–∞–ª—ñ–≤: –º–æ–∂–µ –∑–Ω–∞–¥–æ–±–∏—Ç–∏—Å—è –±–∞–≥–∞—Ç–æ–∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏–π –º–µ—Ç–æ–¥")
print("  ‚Ä¢ <S¬≤> > S(S+1) + 0.1 ‚Üí —Å–ø—ñ–Ω–æ–≤–µ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è!")

print("\n" + "=" * 60)
print("–í–ò–°–ù–û–í–ö–ò:")
print("=" * 60)
print("‚Ä¢ O‚ÇÇ - –ø–∞—Ä–∞–º–∞–≥–Ω–µ—Ç–∏–∫ –∑ –¥–≤–æ–º–∞ –Ω–µ—Å–ø–∞—Ä–µ–Ω–∏–º–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–∞–º–∏")
print("‚Ä¢ UHF –º–∞—î —Å–ø—ñ–Ω–æ–≤–µ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è –¥–ª—è –±–∞–≥–∞—Ç–æ–µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏—Ö —Å–∏—Å—Ç–µ–º")
print("‚Ä¢ ROHF –≤—ñ–ª—å–Ω–∏–π –≤—ñ–¥ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è, –∞–ª–µ –º–µ–Ω—à —Ç–æ—á–Ω–∏–π")
print("‚Ä¢ UB3LYP - —Ö–æ—Ä–æ—à–∏–π –∫–æ–º–ø—Ä–æ–º—ñ—Å (–º–∞–ª–µ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è, –≥–∞—Ä–Ω–∞ –µ–Ω–µ—Ä–≥—ñ—è)")
print("‚Ä¢ –ó–∞–≤–∂–¥–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ <S¬≤> –¥–ª—è —Å–∏—Å—Ç–µ–º –∑ –≤—ñ–¥–∫—Ä–∏—Ç–∏–º–∏ –æ–±–æ–ª–æ–Ω–∫–∞–º–∏!")
print("=" * 60)